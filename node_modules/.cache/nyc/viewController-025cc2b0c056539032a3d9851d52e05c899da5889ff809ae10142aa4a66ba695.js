function cov_6fvav61cs(){var path="/home/teja/saiteja/minor_pro/controller/viewController.js";var hash="8982e43aa7c68b86e48f6f700d2e454b9211f1fb";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/teja/saiteja/minor_pro/controller/viewController.js",statementMap:{"0":{start:{line:1,column:24},end:{line:1,column:53}},"1":{start:{line:2,column:11},end:{line:2,column:34}},"2":{start:{line:5,column:4},end:{line:43,column:5}},"3":{start:{line:7,column:23},end:{line:7,column:50}},"4":{start:{line:8,column:19},end:{line:8,column:47}},"5":{start:{line:11,column:32},end:{line:11,column:101}},"6":{start:{line:14,column:8},end:{line:14,column:29}},"7":{start:{line:15,column:8},end:{line:17,column:9}},"8":{start:{line:16,column:12},end:{line:16,column:43}},"9":{start:{line:19,column:30},end:{line:33,column:10}},"10":{start:{line:20,column:12},end:{line:32,column:13}},"11":{start:{line:21,column:31},end:{line:24,column:17}},"12":{start:{line:25,column:29},end:{line:25,column:65}},"13":{start:{line:26,column:16},end:{line:29,column:18}},"14":{start:{line:31,column:16},end:{line:31,column:31}},"15":{start:{line:36,column:23},end:{line:36,column:55}},"16":{start:{line:37,column:8},end:{line:37,column:57}},"17":{start:{line:41,column:8},end:{line:41,column:39}},"18":{start:{line:42,column:8},end:{line:42,column:83}},"19":{start:{line:47,column:0},end:{line:47,column:40}}},fnMap:{"0":{name:"getPendingRequests",decl:{start:{line:4,column:15},end:{line:4,column:33}},loc:{start:{line:4,column:44},end:{line:44,column:1}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:19,column:50},end:{line:19,column:51}},loc:{start:{line:19,column:69},end:{line:33,column:9}},line:19}},branchMap:{"0":{loc:{start:{line:15,column:8},end:{line:17,column:9}},type:"if",locations:[{start:{line:15,column:8},end:{line:17,column:9}},{start:{line:15,column:8},end:{line:17,column:9}}],line:15},"1":{loc:{start:{line:20,column:12},end:{line:32,column:13}},type:"if",locations:[{start:{line:20,column:12},end:{line:32,column:13}},{start:{line:20,column:12},end:{line:32,column:13}}],line:20}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"8982e43aa7c68b86e48f6f700d2e454b9211f1fb"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_6fvav61cs=function(){return actualCoverage;};}return actualCoverage;}cov_6fvav61cs();const{mongoClient}=(cov_6fvav61cs().s[0]++,require('../config/database'));const s3=(cov_6fvav61cs().s[1]++,require('../config/s3'));async function getPendingRequests(req,res){cov_6fvav61cs().f[0]++;cov_6fvav61cs().s[2]++;try{// Connect to MongoDB
const client=(cov_6fvav61cs().s[3]++,await mongoClient.connect());const db=(cov_6fvav61cs().s[4]++,client.db('facerecognition'));// Fetch all pending requests
const pendingRequests=(cov_6fvav61cs().s[5]++,await db.collection('reg_req').find({request:'pending'}).toArray());// Close MongoDB client
cov_6fvav61cs().s[6]++;await client.close();cov_6fvav61cs().s[7]++;if(pendingRequests.length==0){cov_6fvav61cs().b[0][0]++;cov_6fvav61cs().s[8]++;res.send("no pending requests");}else{cov_6fvav61cs().b[0][1]++;}// Fetch images from S3 bucket
const imagePromises=(cov_6fvav61cs().s[9]++,pendingRequests.map(async request=>{cov_6fvav61cs().f[1]++;cov_6fvav61cs().s[10]++;if(request.imageUrl){cov_6fvav61cs().b[1][0]++;// Check if imageUrl is defined
const params=(cov_6fvav61cs().s[11]++,{Bucket:'faces-samp',Key:request.imageUrl.split('/').slice(-2).join('/')// Extracting key from imageUrl
});const data=(cov_6fvav61cs().s[12]++,await s3.getObject(params).promise());cov_6fvav61cs().s[13]++;return{...request,image:data.Body.toString('base64')// Convert image data to base64 string
};}else{cov_6fvav61cs().b[1][1]++;cov_6fvav61cs().s[14]++;return request;// Return request as it is if imageUrl is not defined
}}));// Wait for all image promises to resolve
const images=(cov_6fvav61cs().s[15]++,await Promise.all(imagePromises));cov_6fvav61cs().s[16]++;res.status(200).send({pendingRequests:images});// Render the pending-requests page and pass the data
//res.render('../views/admin/pending-requests', { pendingRequests: images });
}catch(error){cov_6fvav61cs().s[17]++;console.error('Error:',error);cov_6fvav61cs().s[18]++;res.status(500).json({success:false,message:'Internal server error'});}}cov_6fvav61cs().s[19]++;module.exports={getPendingRequests};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfNmZ2YXY2MWNzIiwiYWN0dWFsQ292ZXJhZ2UiLCJtb25nb0NsaWVudCIsInMiLCJyZXF1aXJlIiwiczMiLCJnZXRQZW5kaW5nUmVxdWVzdHMiLCJyZXEiLCJyZXMiLCJmIiwiY2xpZW50IiwiY29ubmVjdCIsImRiIiwicGVuZGluZ1JlcXVlc3RzIiwiY29sbGVjdGlvbiIsImZpbmQiLCJyZXF1ZXN0IiwidG9BcnJheSIsImNsb3NlIiwibGVuZ3RoIiwiYiIsInNlbmQiLCJpbWFnZVByb21pc2VzIiwibWFwIiwiaW1hZ2VVcmwiLCJwYXJhbXMiLCJCdWNrZXQiLCJLZXkiLCJzcGxpdCIsInNsaWNlIiwiam9pbiIsImRhdGEiLCJnZXRPYmplY3QiLCJwcm9taXNlIiwiaW1hZ2UiLCJCb2R5IiwidG9TdHJpbmciLCJpbWFnZXMiLCJQcm9taXNlIiwiYWxsIiwic3RhdHVzIiwiZXJyb3IiLCJjb25zb2xlIiwianNvbiIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInZpZXdDb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgbW9uZ29DbGllbnQgfSA9IHJlcXVpcmUoJy4uL2NvbmZpZy9kYXRhYmFzZScpO1xuY29uc3QgczMgPSByZXF1aXJlKCcuLi9jb25maWcvczMnKTtcblxuYXN5bmMgZnVuY3Rpb24gZ2V0UGVuZGluZ1JlcXVlc3RzKHJlcSwgcmVzKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gQ29ubmVjdCB0byBNb25nb0RCXG4gICAgICAgIGNvbnN0IGNsaWVudCA9IGF3YWl0IG1vbmdvQ2xpZW50LmNvbm5lY3QoKTtcbiAgICAgICAgY29uc3QgZGIgPSBjbGllbnQuZGIoJ2ZhY2VyZWNvZ25pdGlvbicpO1xuXG4gICAgICAgIC8vIEZldGNoIGFsbCBwZW5kaW5nIHJlcXVlc3RzXG4gICAgICAgIGNvbnN0IHBlbmRpbmdSZXF1ZXN0cyA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3JlZ19yZXEnKS5maW5kKHsgcmVxdWVzdDogJ3BlbmRpbmcnIH0pLnRvQXJyYXkoKTtcblxuICAgICAgICAvLyBDbG9zZSBNb25nb0RCIGNsaWVudFxuICAgICAgICBhd2FpdCBjbGllbnQuY2xvc2UoKTtcbiAgICAgICAgaWYocGVuZGluZ1JlcXVlc3RzLmxlbmd0aD09MCl7XG4gICAgICAgICAgICByZXMuc2VuZChcIm5vIHBlbmRpbmcgcmVxdWVzdHNcIilcbiAgICAgICAgfVxuICAgICAgICAvLyBGZXRjaCBpbWFnZXMgZnJvbSBTMyBidWNrZXRcbiAgICAgICAgY29uc3QgaW1hZ2VQcm9taXNlcyA9IHBlbmRpbmdSZXF1ZXN0cy5tYXAoYXN5bmMgKHJlcXVlc3QpID0+IHtcbiAgICAgICAgICAgIGlmIChyZXF1ZXN0LmltYWdlVXJsKSB7IC8vIENoZWNrIGlmIGltYWdlVXJsIGlzIGRlZmluZWRcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgICAgIEJ1Y2tldDogJ2ZhY2VzLXNhbXAnLFxuICAgICAgICAgICAgICAgICAgICBLZXk6IHJlcXVlc3QuaW1hZ2VVcmwuc3BsaXQoJy8nKS5zbGljZSgtMikuam9pbignLycpLCAvLyBFeHRyYWN0aW5nIGtleSBmcm9tIGltYWdlVXJsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgczMuZ2V0T2JqZWN0KHBhcmFtcykucHJvbWlzZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLnJlcXVlc3QsXG4gICAgICAgICAgICAgICAgICAgIGltYWdlOiBkYXRhLkJvZHkudG9TdHJpbmcoJ2Jhc2U2NCcpLCAvLyBDb252ZXJ0IGltYWdlIGRhdGEgdG8gYmFzZTY0IHN0cmluZ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXF1ZXN0OyAvLyBSZXR1cm4gcmVxdWVzdCBhcyBpdCBpcyBpZiBpbWFnZVVybCBpcyBub3QgZGVmaW5lZFxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBXYWl0IGZvciBhbGwgaW1hZ2UgcHJvbWlzZXMgdG8gcmVzb2x2ZVxuICAgICAgICBjb25zdCBpbWFnZXMgPSBhd2FpdCBQcm9taXNlLmFsbChpbWFnZVByb21pc2VzKTtcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQoeyBwZW5kaW5nUmVxdWVzdHM6IGltYWdlcyB9KVxuICAgICAgICAvLyBSZW5kZXIgdGhlIHBlbmRpbmctcmVxdWVzdHMgcGFnZSBhbmQgcGFzcyB0aGUgZGF0YVxuICAgICAgICAvL3Jlcy5yZW5kZXIoJy4uL3ZpZXdzL2FkbWluL3BlbmRpbmctcmVxdWVzdHMnLCB7IHBlbmRpbmdSZXF1ZXN0czogaW1hZ2VzIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yOicsIGVycm9yKTtcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSk7XG4gICAgfVxufVxuXG5cbm1vZHVsZS5leHBvcnRzID0geyBnZXRQZW5kaW5nUmVxdWVzdHMgfTtcbiJdLCJtYXBwaW5ncyI6IisvRUFlWTtBQUFBQSxhQUFBLFNBQUFBLENBQUEsU0FBQUMsY0FBQSxXQUFBQSxjQUFBLEVBQUFELGFBQUEsR0FmWixLQUFNLENBQUVFLFdBQVksQ0FBQyxFQUFBRixhQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLG9CQUFvQixDQUFDLEVBQ3JELEtBQU0sQ0FBQUMsRUFBRSxFQUFBTCxhQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLGNBQWMsQ0FBQyxFQUVsQyxjQUFlLENBQUFFLGtCQUFrQkEsQ0FBQ0MsR0FBRyxDQUFFQyxHQUFHLENBQUUsQ0FBQVIsYUFBQSxHQUFBUyxD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