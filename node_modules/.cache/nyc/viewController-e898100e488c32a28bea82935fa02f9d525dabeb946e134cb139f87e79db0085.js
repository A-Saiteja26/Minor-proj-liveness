function cov_6fvav61cs(){var path="/home/teja/saiteja/minor_pro/controller/viewController.js";var hash="2995903b7d1a49afc0d13f4d5428a3e4a3b3ae49";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/teja/saiteja/minor_pro/controller/viewController.js",statementMap:{"0":{start:{line:1,column:24},end:{line:1,column:53}},"1":{start:{line:2,column:11},end:{line:2,column:34}},"2":{start:{line:5,column:4},end:{line:33,column:5}},"3":{start:{line:6,column:23},end:{line:6,column:50}},"4":{start:{line:7,column:19},end:{line:7,column:47}},"5":{start:{line:8,column:32},end:{line:8,column:101}},"6":{start:{line:9,column:8},end:{line:9,column:29}},"7":{start:{line:10,column:8},end:{line:12,column:9}},"8":{start:{line:11,column:12},end:{line:11,column:43}},"9":{start:{line:13,column:30},end:{line:27,column:10}},"10":{start:{line:14,column:12},end:{line:26,column:13}},"11":{start:{line:15,column:31},end:{line:18,column:17}},"12":{start:{line:19,column:29},end:{line:19,column:65}},"13":{start:{line:20,column:16},end:{line:23,column:18}},"14":{start:{line:25,column:16},end:{line:25,column:31}},"15":{start:{line:28,column:23},end:{line:28,column:55}},"16":{start:{line:29,column:8},end:{line:29,column:57}},"17":{start:{line:31,column:8},end:{line:31,column:39}},"18":{start:{line:32,column:8},end:{line:32,column:83}},"19":{start:{line:37,column:0},end:{line:37,column:40}}},fnMap:{"0":{name:"getPendingRequests",decl:{start:{line:4,column:15},end:{line:4,column:33}},loc:{start:{line:4,column:44},end:{line:34,column:1}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:13,column:50},end:{line:13,column:51}},loc:{start:{line:13,column:69},end:{line:27,column:9}},line:13}},branchMap:{"0":{loc:{start:{line:10,column:8},end:{line:12,column:9}},type:"if",locations:[{start:{line:10,column:8},end:{line:12,column:9}},{start:{line:10,column:8},end:{line:12,column:9}}],line:10},"1":{loc:{start:{line:14,column:12},end:{line:26,column:13}},type:"if",locations:[{start:{line:14,column:12},end:{line:26,column:13}},{start:{line:14,column:12},end:{line:26,column:13}}],line:14}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"2995903b7d1a49afc0d13f4d5428a3e4a3b3ae49"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_6fvav61cs=function(){return actualCoverage;};}return actualCoverage;}cov_6fvav61cs();const{mongoClient}=(cov_6fvav61cs().s[0]++,require('../config/database'));const s3=(cov_6fvav61cs().s[1]++,require('../config/s3'));async function getPendingRequests(req,res){cov_6fvav61cs().f[0]++;cov_6fvav61cs().s[2]++;try{const client=(cov_6fvav61cs().s[3]++,await mongoClient.connect());const db=(cov_6fvav61cs().s[4]++,client.db('facerecognition'));const pendingRequests=(cov_6fvav61cs().s[5]++,await db.collection('reg_req').find({request:'pending'}).toArray());cov_6fvav61cs().s[6]++;await client.close();cov_6fvav61cs().s[7]++;if(pendingRequests.length==0){cov_6fvav61cs().b[0][0]++;cov_6fvav61cs().s[8]++;res.send("no pending requests");}else{cov_6fvav61cs().b[0][1]++;}const imagePromises=(cov_6fvav61cs().s[9]++,pendingRequests.map(async request=>{cov_6fvav61cs().f[1]++;cov_6fvav61cs().s[10]++;if(request.imageUrl){cov_6fvav61cs().b[1][0]++;const params=(cov_6fvav61cs().s[11]++,{Bucket:'faces-samp',Key:request.imageUrl.split('/').slice(-2).join('/')// Extracting key from imageUrl
});const data=(cov_6fvav61cs().s[12]++,await s3.getObject(params).promise());cov_6fvav61cs().s[13]++;return{...request,image:data.Body.toString('base64')// Convert image data to base64 string
};}else{cov_6fvav61cs().b[1][1]++;cov_6fvav61cs().s[14]++;return request;// Return request as it is if imageUrl is not defined
}}));const images=(cov_6fvav61cs().s[15]++,await Promise.all(imagePromises));cov_6fvav61cs().s[16]++;res.status(200).send({pendingRequests:images});}catch(error){cov_6fvav61cs().s[17]++;console.error('Error:',error);cov_6fvav61cs().s[18]++;res.status(500).json({success:false,message:'Internal server error'});}}cov_6fvav61cs().s[19]++;module.exports={getPendingRequests};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfNmZ2YXY2MWNzIiwiYWN0dWFsQ292ZXJhZ2UiLCJtb25nb0NsaWVudCIsInMiLCJyZXF1aXJlIiwiczMiLCJnZXRQZW5kaW5nUmVxdWVzdHMiLCJyZXEiLCJyZXMiLCJmIiwiY2xpZW50IiwiY29ubmVjdCIsImRiIiwicGVuZGluZ1JlcXVlc3RzIiwiY29sbGVjdGlvbiIsImZpbmQiLCJyZXF1ZXN0IiwidG9BcnJheSIsImNsb3NlIiwibGVuZ3RoIiwiYiIsInNlbmQiLCJpbWFnZVByb21pc2VzIiwibWFwIiwiaW1hZ2VVcmwiLCJwYXJhbXMiLCJCdWNrZXQiLCJLZXkiLCJzcGxpdCIsInNsaWNlIiwiam9pbiIsImRhdGEiLCJnZXRPYmplY3QiLCJwcm9taXNlIiwiaW1hZ2UiLCJCb2R5IiwidG9TdHJpbmciLCJpbWFnZXMiLCJQcm9taXNlIiwiYWxsIiwic3RhdHVzIiwiZXJyb3IiLCJjb25zb2xlIiwianNvbiIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInZpZXdDb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgbW9uZ29DbGllbnQgfSA9IHJlcXVpcmUoJy4uL2NvbmZpZy9kYXRhYmFzZScpO1xuY29uc3QgczMgPSByZXF1aXJlKCcuLi9jb25maWcvczMnKTtcblxuYXN5bmMgZnVuY3Rpb24gZ2V0UGVuZGluZ1JlcXVlc3RzKHJlcSwgcmVzKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY2xpZW50ID0gYXdhaXQgbW9uZ29DbGllbnQuY29ubmVjdCgpO1xuICAgICAgICBjb25zdCBkYiA9IGNsaWVudC5kYignZmFjZXJlY29nbml0aW9uJyk7XG4gICAgICAgIGNvbnN0IHBlbmRpbmdSZXF1ZXN0cyA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3JlZ19yZXEnKS5maW5kKHsgcmVxdWVzdDogJ3BlbmRpbmcnIH0pLnRvQXJyYXkoKTtcbiAgICAgICAgYXdhaXQgY2xpZW50LmNsb3NlKCk7XG4gICAgICAgIGlmKHBlbmRpbmdSZXF1ZXN0cy5sZW5ndGg9PTApe1xuICAgICAgICAgICAgcmVzLnNlbmQoXCJubyBwZW5kaW5nIHJlcXVlc3RzXCIpXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaW1hZ2VQcm9taXNlcyA9IHBlbmRpbmdSZXF1ZXN0cy5tYXAoYXN5bmMgKHJlcXVlc3QpID0+IHtcbiAgICAgICAgICAgIGlmIChyZXF1ZXN0LmltYWdlVXJsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGFyYW1zID0ge1xuICAgICAgICAgICAgICAgICAgICBCdWNrZXQ6ICdmYWNlcy1zYW1wJyxcbiAgICAgICAgICAgICAgICAgICAgS2V5OiByZXF1ZXN0LmltYWdlVXJsLnNwbGl0KCcvJykuc2xpY2UoLTIpLmpvaW4oJy8nKSwgLy8gRXh0cmFjdGluZyBrZXkgZnJvbSBpbWFnZVVybFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHMzLmdldE9iamVjdChwYXJhbXMpLnByb21pc2UoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAuLi5yZXF1ZXN0LFxuICAgICAgICAgICAgICAgICAgICBpbWFnZTogZGF0YS5Cb2R5LnRvU3RyaW5nKCdiYXNlNjQnKSwgLy8gQ29udmVydCBpbWFnZSBkYXRhIHRvIGJhc2U2NCBzdHJpbmdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVxdWVzdDsgLy8gUmV0dXJuIHJlcXVlc3QgYXMgaXQgaXMgaWYgaW1hZ2VVcmwgaXMgbm90IGRlZmluZWRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGltYWdlcyA9IGF3YWl0IFByb21pc2UuYWxsKGltYWdlUHJvbWlzZXMpO1xuICAgICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZCh7IHBlbmRpbmdSZXF1ZXN0czogaW1hZ2VzIH0pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3I6JywgZXJyb3IpO1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyB9KTtcbiAgICB9XG59XG5cblxubW9kdWxlLmV4cG9ydHMgPSB7IGdldFBlbmRpbmdSZXF1ZXN0cyB9O1xuIl0sIm1hcHBpbmdzIjoiMi9FQWVZO0FBQUFBLGFBQUEsU0FBQUEsQ0FBQSxTQUFBQyxjQUFBLFdBQUFBLGNBQUEsRUFBQUQsYUFBQSxHQWZaLEtBQU0sQ0FBRUUsV0FBWSxDQUFDLEVBQUFGLGFBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMsb0JBQW9CLENBQUMsRUFDckQsS0FBTSxDQUFBQyxFQUFFLEVBQUFMLGFBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMsY0FBYyxDQUFDLEVBRWxDLGNBQWUsQ0FBQUUsa0JBQWtCQSxDQUFDQyxHQUFHLENBQUVDLEdBQUcsQ0FBRSxDQUFBUixhQUFBLEdBQUFTLENBQUEsTUFBQVQsYUFBQSxHQUFBRyxDQUFBLE1BQ3hDLEdBQUksQ0FDQSxLQUFNLENBQUFPLE1BQU0sRUFBQVYsYUFBQSxHQUFBRyxDQUFBLE1BQUcsS0FBTSxDQUFBRCxXQUFXLENBQUNTLE9BQU8sQ0FBQyxDQUFDLEVBQzFDLEtBQU0sQ0FBQUMsRUFBRSxFQUFBWixhQUFBLEdBQUFHLENBQUEsTUFBR08sTUFBTSxDQUFDRSxFQUFFLENBQUMsaUJBQWlCLENBQUMsRUFDdkMsS0FBTSxDQUFBQyxlQUFlLEVBQUFiLGFBQUEsR0FBQUcsQ0FBQSxNQUFHLEtBQU0sQ0FBQVMsRUFBRSxDQUFDRSxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUNDLElBQUksQ0FBQyxDQUFFQyxPQUFPLENBQUUsU0FBVSxDQUFDLENBQUMsQ0FBQ0MsT0FBTyxDQUFDLENBQUMsRUFBQ2pCLGFBQUEsR0FBQUcsQ0FBQSxNQUM5RixLQUFNLENBQUFPLE1BQU0sQ0FBQ1EsS0FBSyxDQUFDLENBQUMsQ0FBQ2xCLGFBQUEsR0FBQUcsQ0FBQSxNQUNyQixHQUFHVSxlQUFlLENBQUNNLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQW5CLGFBQUEsR0FBQW9CLENBQUEsU0FBQXBCLGFBQUEsR0FBQUcsQ0FBQSxNQUN6QkssR0FBRyxDQUFDYSxJQUFJLENBQUMscUJBQXFCLENBQUMsQ0FDbkMsQ0FBQyxLQUFBckIsYUFBQSxHQUFBb0IsQ0FBQSxVQUNELEtBQU0sQ0FBQUUsYUFBYSxFQUFBdEIsYUFBQSxHQUFBRyxDQUFBLE1BQUdVLGVBQWUsQ0FBQ1UsR0FBRyxDQUFDLEtBQU8sQ0FBQVAsT0FBTyxFQUFLLENBQUFoQixhQUFBLEdBQUFTLENBQUEsTUFBQVQsYUFBQSxHQUFBRyxDQUFBLE9BQ3pELEdBQUlhLE9BQU8sQ0FBQ1EsUUFBUSxDQUFFLENBQUF4QixhQUFBLEdBQUFvQixDQUFBLFNBQ2xCLEtBQU0sQ0FBQUssTUFBTSxFQUFBekIsYUFBQSxHQUFBRyxDQUFBLE9BQUcsQ0FDWHVCLE1BQU0sQ0FBRSxZQUFZLENBQ3BCQyxHQUFHLENBQUVYLE9BQU8sQ0FBQ1EsUUFBUSxDQUFDSSxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUNDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDQyxJQUFJLENBQUMsR0FBRyxDQUFHO0FBQzFELENBQUMsRUFDRCxLQUFNLENBQUFDLElBQUksRUFBQS9CLGFBQUEsR0FBQUcsQ0FBQSxPQUFHLEtBQU0sQ0FBQUUsRUFBRSxDQUFDMkIsU0FBUyxDQUFDUCxNQUFNLENBQUMsQ0FBQ1EsT0FBTyxDQUFDLENBQUMsRUFBQ2pDLGFBQUEsR0FBQUcsQ0FBQSxPQUNsRCxNQUFPLENBQ0gsR0FBR2EsT0FBTyxDQUNWa0IsS0FBSyxDQUFFSCxJQUFJLENBQUNJLElBQUksQ0FBQ0MsUUFBUSxDQUFDLFFBQVEsQ0FBRztBQUN6QyxDQUFDLENBQ0wsQ0FBQyxJQUFNLENBQUFwQyxhQUFBLEdBQUFvQixDQUFBLFNBQUFwQixhQUFBLEdBQUFHLENBQUEsT0FDSCxNQUFPLENBQUFhLE9BQU8sQ0FBRTtBQUNwQixDQUNKLENBQUMsQ0FBQyxFQUNGLEtBQU0sQ0FBQXFCLE1BQU0sRUFBQXJDLGFBQUEsR0FBQUcsQ0FBQSxPQUFHLEtBQU0sQ0FBQW1DLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDakIsYUFBYSxDQUFDLEVBQUN0QixhQUFBLEdBQUFHLENBQUEsT0FDaERLLEdBQUcsQ0FBQ2dDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ25CLElBQUksQ0FBQyxDQUFFUixlQUFlLENBQUV3QixNQUFPLENBQUMsQ0FBQyxDQUNyRCxDQUFFLE1BQU9JLEtBQUssQ0FBRSxDQUFBekMsYUFBQSxHQUFBRyxDQUFBLE9BQ1p1QyxPQUFPLENBQUNELEtBQUssQ0FBQyxRQUFRLENBQUVBLEtBQUssQ0FBQyxDQUFDekMsYUFBQSxHQUFBRyxDQUFBLE9BQy9CSyxHQUFHLENBQUNnQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNHLElBQUksQ0FBQyxDQUFFQyxPQUFPLENBQUUsS0FBSyxDQUFFQyxPQUFPLENBQUUsdUJBQXdCLENBQUMsQ0FBQyxDQUM5RSxDQUNKLENBQUM3QyxhQUFBLEdBQUFHLENBQUEsT0FHRDJDLE1BQU0sQ0FBQ0MsT0FBTyxDQUFHLENBQUV6QyxrQkFBbUIsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==